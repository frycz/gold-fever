{"version":3,"sources":["App.tsx","Grid.tsx","reportWebVitals.ts","index.tsx"],"names":["config","Grid","width","height","playerX","playerY","items","enemies","className","Array","fill","map","_","y","style","display","x","find","item","enemy","pathfinder","PF","AStarFinder","initialState","points","player","init","collectGold","state","character","onItemCollected","itemIndex","findIndex","slice","Math","floor","random","length","stateReducer","gridWidth","gridHeight","action","reducers","reduce","accState","reducer","movePlayerReducer","newX","newY","movePlayer","moveEnemiesReducer","index","moveEnemy","collectGoldReducer","newState","enemyIndex","grid","setWalkableAt","forEach","paths","findPath","clone","filter","path","sort","pathA","pathB","newEnemyX","newEnemyY","App","React","useReducer","dispatch","keyDownHandler","e","key","useEffect","window","addEventListener","removeEventListener","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.c391bb84.chunk.js","sourcesContent":["import React from \"react\";\nimport PF from \"pathfinding\";\nimport { Grid } from \"./Grid\";\n\nimport \"./App.css\";\n\ntype Player = {\n  x: number;\n  y: number;\n};\n\ntype Item = {\n  x: number;\n  y: number;\n};\n\ntype Enemy = {\n  x: number;\n  y: number;\n};\n\ntype Action = \"up\" | \"down\" | \"left\" | \"right\";\n\ntype State = {\n  points: number;\n  player: Player;\n  items: Array<Item>;\n  enemies: Array<Enemy>;\n};\n\ntype Config = {\n  gridWidth: number;\n  gridHeight: number;\n};\n\ntype Reducer = (state: State, action: Action, config: Config) => State;\n\nconst gridWidth = 10;\nconst gridHeight = 10;\n\nvar pathfinder = new PF.AStarFinder();\n\nconst initialState: State = {\n  points: 0,\n  player: { x: 0, y: 0 },\n  items: [\n    { x: 2, y: 7 },\n    { x: 8, y: 5 },\n    { x: 4, y: 5 },\n    { x: 6, y: 3 },\n  ],\n  enemies: [\n    // { x: 0, y: 9 },\n    // { x: 9, y: 0 },\n    { x: 9, y: 9 },\n  ],\n};\n\nconst init = () => initialState;\n\nconst collectGold = (\n  state: State,\n  character: Player | Enemy,\n  onItemCollected: (state: State) => State\n) => {\n  const itemIndex = state.items.findIndex(\n    (item) => item.x === character.x && item.y === character.y\n  );\n\n  return {\n    ...state,\n    ...(itemIndex !== -1\n      ? {\n          ...onItemCollected(state),\n          items:\n            itemIndex !== -1\n              ? [\n                  ...state.items.slice(0, itemIndex),\n                  {\n                    x: Math.floor(gridWidth * Math.random()),\n                    y: Math.floor(gridHeight * Math.random()),\n                  },\n                  ...state.items.slice(itemIndex + 1, state.items.length),\n                ]\n              : state.items,\n        }\n      : {}),\n  };\n};\n\nconst movePlayer = (state: State, action: Action, config: Config) => {\n  let newX = state.player.x;\n  let newY = state.player.y;\n\n  if (action === \"up\") {\n    newX = state.player.x;\n    newY = state.player.y > 0 ? state.player.y - 1 : state.player.y;\n  }\n  if (action === \"down\") {\n    newX = state.player.x;\n    newY =\n      state.player.y < config.gridHeight - 1\n        ? state.player.y + 1\n        : state.player.y;\n  }\n  if (action === \"left\") {\n    newX = state.player.x > 0 ? state.player.x - 1 : state.player.x;\n    newY = state.player.y;\n  }\n  if (action === \"right\") {\n    newX =\n      state.player.x < config.gridWidth - 1\n        ? state.player.x + 1\n        : state.player.x;\n    newY = state.player.y;\n  }\n\n  return {\n    ...state,\n    player: {\n      x: newX,\n      y: newY,\n    },\n  };\n};\n\nconst getStateReducer =\n  (config: Config) =>\n  (initialState: State, action: Action, reducers: Array<Reducer>) =>\n    reducers.reduce(\n      (accState, reducer) => reducer(accState, action, config),\n      initialState\n    );\n\nconst stateReducer = getStateReducer({ gridWidth, gridHeight });\n\nconst movePlayerReducer = (accState: State, action: Action, config: Config) =>\n  movePlayer(accState, action, config);\nconst moveEnemiesReducer = (accState: State, action: Action, config: Config) =>\n  stateReducer(\n    accState,\n    action,\n    accState.enemies.map(\n      (_, index) => (accState, action, config) =>\n        moveEnemy(accState, index, pathfinder)\n    )\n  );\nconst collectGoldReducer = (accState: State, action: Action, config: Config) =>\n  stateReducer(accState, action, [\n    (accState, action, config) =>\n      collectGold(accState, accState.player, (newState) => ({\n        ...newState,\n        points: newState.points + 1,\n      })),\n    (accState, action, config) =>\n      stateReducer(\n        accState,\n        action,\n        accState.enemies.map(\n          (enemy, index) => (accState: State, action: Action, config: Config) =>\n            collectGold(accState, enemy, (newState) => ({\n              ...newState,\n              points: newState.points - 1,\n            }))\n        )\n      ),\n  ]);\n\nconst moveEnemy = (\n  state: State,\n  enemyIndex: number,\n  pathfinder: PF.AStarFinder\n): State => {\n  const enemy = { ...state.enemies[enemyIndex] };\n  const grid = new PF.Grid(gridWidth, gridHeight);\n\n  grid.setWalkableAt(state.player.x, state.player.y, false);\n  state.enemies.forEach((_, index) => {\n    if (index !== enemyIndex) {\n      grid.setWalkableAt(state.enemies[index].x, state.enemies[index].y, false);\n    }\n  });\n\n  const paths = state.items\n    .map((item) =>\n      pathfinder.findPath(enemy.x, enemy.y, item.x, item.y, grid.clone())\n    )\n    .filter((path) => path.length)\n    .sort((pathA, pathB) => pathA.length - pathB.length);\n\n  const [newEnemyX, newEnemyY] = paths[0][1] ? paths[0][1] : [enemy.x, enemy.y];\n\n  enemy.x = newEnemyX <= 9 && newEnemyX >= 0 ? newEnemyX : enemy.x;\n  enemy.y = newEnemyY <= 9 && newEnemyY >= 0 ? newEnemyY : enemy.y;\n\n  return {\n    ...state,\n    enemies: [\n      ...state.enemies.slice(0, enemyIndex),\n      enemy,\n      ...state.enemies.slice(enemyIndex + 1, state.enemies.length),\n    ],\n  };\n};\n\nconst reducer = (state: State, action: Action): State =>\n  stateReducer(state, action, [\n    movePlayerReducer,\n    moveEnemiesReducer,\n    collectGoldReducer,\n  ]);\n\nfunction App() {\n  const [state, dispatch] = React.useReducer(reducer, initialState, init);\n\n  const keyDownHandler = (e: KeyboardEvent) => {\n    if (e.key === \"ArrowUp\") {\n      dispatch(\"up\");\n    }\n    if (e.key === \"ArrowDown\") {\n      dispatch(\"down\");\n    }\n    if (e.key === \"ArrowLeft\") {\n      dispatch(\"left\");\n    }\n    if (e.key === \"ArrowRight\") {\n      dispatch(\"right\");\n    }\n  };\n\n  React.useEffect(() => {\n    window.addEventListener(\"keydown\", keyDownHandler);\n\n    return () => window.removeEventListener(\"keydown\", keyDownHandler);\n  }, []);\n\n  return (\n    <div className=\"grid-wrapper\">\n      <div className=\"grid-container\">\n        <div className=\"side\">\n          <div className=\"game-title\">Gold Fever</div>\n          <div className=\"game-description\">Collect all the gold</div>\n          <div className=\"game-instruction\">Use arrow keys to move</div>\n        </div>\n        <Grid\n          width={gridWidth}\n          height={gridHeight}\n          playerX={state.player.x}\n          playerY={state.player.y}\n          items={state.items}\n          enemies={state.enemies}\n        />\n        <div className=\"side\">\n          <div className=\"score\">\n            <div className=\"score-title\">Score:</div>\n            <div className=\"score-value\">{state.points}</div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","import * as React from \"react\";\n\nimport \"./Grid.css\";\n\ntype Props = {\n  width: number;\n  height: number;\n  playerX: number;\n  playerY: number;\n  items: Array<{ x: number; y: number }>;\n  enemies: Array<{ x: number; y: number }>;\n};\n\nexport const Grid = ({\n  width,\n  height,\n  playerX,\n  playerY,\n  items,\n  enemies,\n}: Props) => (\n  <div className=\"grid\">\n    {Array(height)\n      .fill(null)\n      .map((_, y) => (\n        <div key={y} style={{ display: \"flex\" }}>\n          {Array(width)\n            .fill(null)\n            .map((_, x) => (\n              <div key={`${x}-${y}`} className=\"grid-field\">\n                {playerX === x && playerY === y ? (\n                  <div className=\"player-field\" />\n                ) : null}\n                {items.find((item) => item.x === x && item.y === y) ? (\n                  <div className=\"item-field\" />\n                ) : null}\n                {enemies.find((enemy) => enemy.x === x && enemy.y === y) ? (\n                  <div className=\"enemy-field\" />\n                ) : null}\n              </div>\n            ))}\n        </div>\n      ))}\n  </div>\n);\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}